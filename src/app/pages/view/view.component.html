<div
  *ngIf="!!game"
  class="header pb-0 pt-5 pt-lg-8"
  style="background-size: cover; background-position: center top"
  [ngStyle]="{ 'background-image': 'url(' + game.bgImage + ')' }"
>
  <video
    *ngIf="!!game.video"
    class="mask"
    autoplay
    loop
    [muted]="'muted'"
    style="height: 90%; object-fit: cover"
  >
    <source [src]="game.video" />
  </video>
  <!-- Mask -->
  <span class="mask bg-gradient-banner"></span>
  <!-- Header container -->
  <div class="container">
    <div class="row">
      <div class="col-lg-7 col-md-10" style="min-width: 450px">
        <button
          class="btn btn-icon d-flex align-items-center p-0"
          (click)="back()"
        >
          <i class="ni ni-bold-left fill-default"></i
          ><span class="text-gray">Go back</span>
        </button>
        <h1 class="display-2 text-white">{{ game.title }}</h1>
        <p class="text-white mt-0 mb-4">OnePlay Rating: {{ game.rating }}/10</p>
        <!-- <p class="text-white mt-0">Available to purchase on</p>
        <a href="#!" class="btn btn-primary">Continue playing</a>
        <a href="#!" class="btn bg-translucent-dark text-white"
          >Add to wishlist</a
        > -->
      </div>
    </div>
  </div>
  <div class="mt-6 pb-8 pt-5 bg-gradient-banner-bottom">
    <div class="row align-items-center container mx-auto">
      <div class="col-lg-6 col-md-12">
        <a
          [href]="'https://www.oneplay.in/play_demo/play?id=' + game.oneplayId"
          target="_blank"
          class="btn btn-white btn-lg w-50"
          >Play Now</a
        >
        <a href="#!" class="btn bg-translucent-dark text-white btn-lg"
          >Add to wishlist</a
        >
        <!-- <p class="text-white">Friends whoâ€™ve played this</p>
        <div class="media">
          <div class="avatar avatar-md rounded-circle mr-2">
            <img src="../../../assets/img/theme/team-1-800x800.jpg" alt="" />
          </div>
          <div class="avatar avatar-md rounded-circle mr-2">
            <img src="../../../assets/img/theme/team-2-800x800.jpg" alt="" />
          </div>
          <div class="avatar avatar-md rounded-circle">
            <img src="../../../assets/img/theme/team-3-800x800.jpg" alt="" />
          </div>
        </div> -->
      </div>
      <div class="col-lg-6 col-md-6 mt-lg-3 mt-md-5">
        <div class="float-right">
          <div
            *ngFor="let genre of game.genreMappings"
            class="btn btn-sm bg-translucent-dark text-white border-white"
          >
            {{ genre }}
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div *ngIf="!!game" class="container pb-6">
  <div class="row">
    <div class="col-md-8 col-12 pr-lg-4">
      <h2 class="text-white mb-4">Top Live Streams</h2>
      <p *ngIf="liveVideos.length === 0" class="text-white-50 text-center">
        No videos found
      </p>
      <div
        *ngFor="let video of liveVideos"
        class="card bg-dark p-3 mb-3"
        (click)="open(modal, video)"
        style="cursor: pointer"
      >
        <div class="media">
          <img
            [width]="video.thumbnails.medium.width - 72"
            [height]="video.thumbnails.medium.height - 40"
            [src]="video.thumbnails.medium.url"
            (click)="open(modal, video)"
            style="border-radius: 4px"
            alt=""
          />
          <div class="ml-3">
            <h3 class="text-white">
              {{ video.title }}
            </h3>
            <div class="media mb-1 align-items-center">
              <img
                [src]="video.channelTitle | avatar"
                class="rounded-circle"
                width="24"
                height="24"
                alt=""
              />
              <span class="text-white-50 small ml-1">{{
                video.channelTitle
              }}</span>
            </div>
            <div class="text-white">
              <span class="text-xs">{{ video.description }}</span>
            </div>
          </div>
        </div>
      </div>
      <div *ngIf="liveVideos.length >= 3" class="text-center p-3">
        <button
          class="btn btn-outline-success btn-sm"
          (click)="showAllLiveVideos = !showAllLiveVideos"
        >
          {{ showAllLiveVideos ? "Show Less" : "Show All" }}
        </button>
      </div>

      <hr class="border-dark" />

      <h2 class="text-white mb-4">Top Videos</h2>
      <p *ngIf="videos.length === 0" class="text-white-50 text-center">
        No videos found
      </p>
      <div
        *ngFor="let video of videos"
        class="card bg-dark p-3 mb-3"
        (click)="open(modal, video)"
        style="cursor: pointer"
      >
        <div class="media">
          <img
            [width]="video.thumbnails.medium.width - 72"
            [height]="video.thumbnails.medium.height - 40"
            [src]="video.thumbnails.medium.url"
            (click)="open(modal, video)"
            style="border-radius: 4px"
            alt=""
          />
          <div class="ml-3">
            <h3 class="text-white">
              {{ video.title }}
            </h3>
            <div class="media mb-1 align-items-center">
              <img
                [src]="video.channelTitle | avatar"
                class="rounded-circle"
                width="24"
                height="24"
                alt=""
              />
              <span class="text-white-50 small ml-1">{{
                video.channelTitle
              }}</span>
            </div>
            <div class="text-white">
              <span class="text-xs">{{ video.description }}</span>
            </div>
          </div>
        </div>
      </div>

      <div *ngIf="videos.length >= 3" class="text-center p-3">
        <button
          class="btn btn-outline-success btn-sm"
          (click)="showAllVideos = !showAllVideos"
        >
          {{ showAllVideos ? "Show Less" : "Show All" }}
        </button>
      </div>
    </div>
    <div class="col-md-4 col-12">
      <div class="card bg-dark p-3 mb-3 mt-5">
        <div class="d-flex align-items-center flex-wrap">
          <span class="text-white mr-3">Available purchase on</span>
          <a
            href="{{ store.link }}"
            target="_blank"
            *ngFor="let store of game.storesMapping"
            ngbTooltip="{{ store.name }}"
            class="mr-1"
          >
            <img
              [src]="store.name | avatar"
              class="rounded-circle"
              width="24"
              height="24"
              alt=""
            />
          </a>
        </div>
      </div>

      <div class="card bg-dark p-3 mb-3">
        <div class="d-flex align-items-center flex-wrap">
          <span class="text-white mr-3">Developers</span>
          <a
            target="_blank"
            *ngFor="let dev of game.developer"
            ngbTooltip="{{ dev }}"
            class="mr-1"
          >
            <img
              [src]="dev | avatar"
              class="rounded-circle"
              width="32"
              height="32"
              alt=""
            />
          </a>
        </div>
      </div>

      <div class="card bg-dark p-3 mb-3">
        <h3 class="text-white">About the game</h3>
        <p
          id="description"
          [innerHTML]="game.description"
          class="text-white-50"
        ></p>
      </div>

      <!-- <div class="card bg-dark p-3">
        <h4 class="text-white">Characters</h4>
        <div class="row overflow-auto">
          <div class="col-1 mr-3">
            <div class="avatar avatar-lg rounded-circle">
              <img src="../../../assets/img/theme/team-1-800x800.jpg" alt="" />
            </div>
          </div>
          <div class="col-1 mr-3">
            <div class="avatar avatar-lg rounded-circle">
              <img src="../../../assets/img/theme/team-2-800x800.jpg" alt="" />
            </div>
          </div>
          <div class="col-1 mr-3">
            <div class="avatar avatar-lg rounded-circle">
              <img src="../../../assets/img/theme/team-3-800x800.jpg" alt="" />
            </div>
          </div>
        </div>
      </div> -->
    </div>
  </div>

  <h3 class="text-white mt-6">Similar games</h3>
  <div class="d-flex overflow-auto">
    <div *ngFor="let similarGame of similarGames" class="mr-4 mb-4">
      <a
        [routerLink]="['/view/' + similarGame.oneplayId]"
        class="card card-block border-0"
        style="width: 219px"
      >
        <img class="card-img" [src]="similarGame.bgImage" height="153" alt="" />
        <div class="mask bg-darker opacity-4"></div>
        <video
          *ngIf="!!similarGame.video"
          class="mask"
          onmouseover="this.play()"
          onmouseout="this.pause();this.currentTime=0;"
          style="border-radius: 4px; height: 100%; object-fit: cover"
        >
          <source [src]="similarGame.video" />
        </video>
        <h5 class="position-absolute left-3 bottom-1 text-white">
          {{ similarGame.title }}
        </h5>
      </a>
    </div>
  </div>
</div>

<ng-template #modal let-d="dismiss">
  <div class="modal-content">
    <iframe
      width="642"
      height="361"
      [src]="playing | safe"
      title="YouTube video player"
      frameborder="0"
      allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
      allowfullscreen
    ></iframe>
  </div>
</ng-template>
