<div class="container-fluid py-7 searchComponent">
  <div class="container-fluid mt-2 mt-md-4 px-0">
    <form class="navbar-search" (submit)="search()">
      <div class="form-group mb-0" [ngClass]="{ focused: isFocused === true }">
        <div class="input-group input-group-alternative border-0">
          <input
            class="form-control searchPleaceholder"
            placeholder="Search games or users"
            type="text"
            [formControl]="queryControl"
            (focus)="isFocused = true"
            (blur)="isFocused = false"
          />
          <div class="input-group-prepend">
            <button
              class="btn input-group-text searchPleaceholder"
              type="submit"
            >
              <i class="fas fa-search"></i>
            </button>
          </div>
        </div>
      </div>
    </form>

    <div class="d-flex justify-content-between mb-1">
      <h1 class="text-white font20 font500 text-center">
        <span *ngIf="!!query">You searched for "{{ query }}" </span>
        <a
          *ngFor="let t of ['games', 'users']"
          href="javascript:void(0)"
          (click)="changeTab(t)"
          class="mx-1 d-none d-md-inline-block"
          [ngClass]="{
            'text-primary': t === tab,
            'text-white-50': t !== tab
          }"
        >
          {{ t | titlecase }}
        </a>
      </h1>
    </div>

    <p
      *ngIf="!tab || tab === 'games'"
      class="mt-3 mb-1 font16 font500 mutedTextColor mb-md-2"
    >
      {{ games.length }} games found
    </p>

    <div
      *ngIf="games.length !== 0"
      class="pb-2 row"
      infinite-scroll
      [infiniteScrollDistance]="5"
      [infiniteScrollThrottle]="200"
      (scrolled)="onScroll()"
    >
      <div
        *ngFor="let game of games"
        class="col-12 col-md-12 col-lg-6 col-xxl-3 mb-1"
      >
        <div
          class="row h-100 gameRowHover py-2"
          [routerLink]="['/view/' + (game | glink)]"
          [queryParams]="keywordQuery"
          style="cursor: pointer"
        >
          <div class="col-auto">
            <img
              [src]="game.textBgImage"
              (error)="onImgError($event)"
              [ngStyle]="{
                filter: game.status === 'live' ? 'none' : 'grayscale(100%)'
              }"
              class="br6"
              width="125"
              height="80"
              alt=""
            />
          </div>
          <div class="col pl-0 align-self-center">
            <p class="font16 font500 offWhitecolor mb-0">
              <span class="truncate-line-clamp">{{ game.title }}</span>
            </p>
            <p class="font14 font500 mb-0 mutedTextColor">
              {{ game.releaseDate.getFullYear() }}
            </p>
          </div>
        </div>
      </div>
    </div>

    <button
      *ngIf="games.length === 4 && !tab"
      class="btn btn-block linearMutedBg text-white border-0 mt-2"
      (click)="searchNavigate('games')"
    >
      See more games
    </button>

    <div
      *ngIf="games.length === 0 && tab === 'games'"
      class="font16 font500 mutedTextColor my-5"
    >
      No games found
    </div>

    <p
      *ngIf="!tab || tab === 'users'"
      class="font16 font500 mutedTextColor mx-3 pt-5"
    >
      {{ users.length }} people found
    </p>

    <div
      *ngIf="users.length !== 0"
      class="py-5 row"
      infinite-scroll
      [infiniteScrollDistance]="5"
      [infiniteScrollThrottle]="200"
      (scrolled)="onScroll()"
    >
      <div *ngFor="let user of users" class="col-12 col-md-6 col-lg-3 mb-1">
        <div class="row gameRowHover py-2">
          <div class="col-auto">
            <img
              [src]="user.photo || (user.name | avatar)"
              class="rounded-circle"
              width="40"
              height="40"
              alt=""
            />
          </div>
          <div class="col align-self-center p-0">
            <p class="m-0 font16 font500 offWhitecolor">
              {{ user.name }}
            </p>
            <p class="m-0 font14 font500 mutedTextColor">
              {{ user.username }}
            </p>
          </div>
          <div class="col-auto align-self-center">
            <button
              type="button offWhitecolor"
              class="btn"
              (click)="addFriend(user)"
            >
              <i class="fas {{ getFriendAddIcon(user) }} offWhitecolor"></i>
            </button>
          </div>
        </div>
      </div>

      <div class="mx-3 w-100">
        <button
          *ngIf="users.length === 4 && !tab"
          class="btn btn-block linearMutedBg text-white border-0 mt-2"
          (click)="searchNavigate('users')"
        >
          See more users
        </button>

        <div
          *ngIf="users.length === 0 && tab === 'users'"
          class="font16 font500 mutedTextColor my-5"
        >
          No users found
        </div>
      </div>

      <div class="position-relative">
        <ngx-ui-loader
          [fgsColor]="'#c32ead'"
          [loaderId]="'scroll'"
          [hasProgressBar]="false"
        ></ngx-ui-loader>
      </div>
    </div>
  </div>

  <ngx-ui-loader [fgsColor]="'#c32ead'"></ngx-ui-loader>
</div>
