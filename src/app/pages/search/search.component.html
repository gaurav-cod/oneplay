<div class="container-fluid py-7">
  <div class="container-fluid mt-2">
    <form class="navbar-search d-block d-lg-none mb-3" (submit)="search()">
      <div class="form-group mb-0" [ngClass]="{ focused: isFocused === true }">
        <div class="input-group input-group-alternative border-0">
          <input
            class="form-control"
            placeholder="Search games or users"
            type="text"
            [formControl]="queryControl"
            (focus)="isFocused = true"
            (blur)="isFocused = false"
          />
          <div class="input-group-prepend">
            <button class="btn input-group-text" type="submit">
              <i class="fas fa-search"></i>
            </button>
          </div>
        </div>
      </div>
    </form>

    <div class="d-flex justify-content-between mb-1">
      <h1 class="text-white font20 font500 text-center">
        <span *ngIf="!!query">You searched for "{{ query }}" </span>
        <a
          *ngFor="let t of ['games', 'users']"
          href="javascript:void(0)"
          (click)="changeTab(t)"
          class="mx-1 d-none d-md-inline-block"
          [ngClass]="{
            'text-primary': t === tab,
            'text-white-50': t !== tab
          }"
        >
          {{ t | titlecase }}
        </a>
      </h1>
    </div>

    <div
      *ngIf="games.length !== 0"
      class="py-lg-4 pb-2 row"
      infinite-scroll
      [infiniteScrollDistance]="5"
      [infiniteScrollThrottle]="200"
      (scrolled)="onScroll()"
    >
    <div *ngFor="let game of games" class="col-12 col-md-6 col-lg-4 col-xxl-3 mb-3">
      <div
        class="list-group-item bg-dark d-flex border-0 h-100"
        [routerLink]="['/view/' + (game | glink)]"
        [queryParams]="keywordQuery"
        style="cursor: pointer"
      >
        <img
          [src]="game.textBgImage"
          (error)="onImgError($event)"
          [ngStyle]="{
            filter: game.status === 'live' ? 'none' : 'grayscale(100%)'
          }"
          class="mr-3"
          width="80"
          height="50"
          alt=""
        />
        <div>
          <p class="list-group-heading text-white m-0">
            {{ game.title }}
          </p>
          <p class="list-group-content text-white-50 small m-0">
            {{ game.releaseDate.getFullYear() }}
          </p>
        </div>
      </div>
    </div>
    </div>

    <button
      *ngIf="games.length === 4 && !tab"
      class="btn btn-block mutedBg text-white border-0"
      (click)="searchNavigate('games')"
    >
      See more games
    </button>

    <div
      *ngIf="games.length === 0 && tab === 'games'"
      class="text-center text-lg text-white-50 my-5"
    >
      No games found
    </div>

    <div
      *ngIf="users.length !== 0"
      class="py-5 row"
      infinite-scroll
      [infiniteScrollDistance]="5"
      [infiniteScrollThrottle]="200"
      (scrolled)="onScroll()"
    >
      <div *ngFor="let user of users" class="col-12 col-md-6 col-lg-3 mb-4">
        <div class="row">
          <img
            [src]="user.photo || (user.name | avatar)"
            class="mr-3"
            width="80"
            height="50"
            alt=""
          />
          <div class="flex-grow-1">
            <p class="list-group-heading text-white m-0">
              {{ user.name }}
            </p>
            <p class="list-group-content text-white-50 small m-0">
              {{ user.username }}
            </p>
          </div>
          <button
            type="button"
            class="btn btn-sm btn-outline-light"
            (click)="addFriend(user)"
          >
            <i class="fas {{ getFriendAddIcon(user) }}"></i>
          </button>
        </div>
      </div>

      <button
        *ngIf="users.length === 4 && !tab"
        class="btn btn-block mutedBg text-white border-0"
        (click)="searchNavigate('users')"
      >
        See more users
      </button>

      <div
        *ngIf="users.length === 0 && tab === 'users'"
        class="text-center text-lg text-white-50 my-5"
      >
        No users found
      </div>

      <div class="position-relative">
        <ngx-ui-loader
          [fgsColor]="'#c32ead'"
          [loaderId]="'scroll'"
          [hasProgressBar]="false"
        ></ngx-ui-loader>
      </div>
    </div>
  </div>

  <ngx-ui-loader [fgsColor]="'#c32ead'"></ngx-ui-loader>
</div>
